{"version":3,"file":"component---src-pages-sign-in-js-366b2e66083aa5230e15.js","mappings":"oPAaA,MAAMA,EAAMC,EAAAA,QAAOC,IAAGC,WAAA,CAAAC,YAAA,eAAAC,YAAA,gBAAVJ,CAAU,2BAIhBK,EAAOL,EAAAA,QAAOM,KAAIJ,WAAA,CAAAC,YAAA,gBAAAC,YAAA,gBAAXJ,CAAW,MAElBO,EAAUP,EAAAA,QAAOC,IAAGC,WAAA,CAAAC,YAAA,mBAAAC,YAAA,gBAAVJ,CAAU,yBAIpBQ,EAAgBR,EAAAA,QAAOC,IAAGC,WAAA,CAAAC,YAAA,yBAAAC,YAAA,gBAAVJ,CAAU,kCAKhC,MAAMS,UAAmBC,EAAAA,UAAgBC,cAAA,SAAAC,WAAA,KAGvCC,kBAAoB,KAElBC,KAAKC,mBAAqBC,aAAY,MAC/BC,EAAAA,EAAAA,OAGLC,YAAW,KAEsB,cAA7BC,OAAOC,SAASC,UACa,aAA7BF,OAAOC,SAASC,WAEhBF,OAAOC,SAAW,IACpB,GACC,IAAK,GACP,IAAK,EACT,KAMDE,QAAUC,UAER,GADAC,EAAEC,mBAEAX,KAAKY,MAAMC,YACkB,IAA5Bb,KAAKY,MAAME,MAAMC,QAA+C,IAA/Bf,KAAKY,MAAMI,SAASD,QAFxD,CAMAf,KAAKiB,SAAS,CACZJ,YAAY,EACZK,OAAO,IAET,UACQC,EAAAA,EAAAA,IAAa,CACjBC,SAAUpB,KAAKY,MAAME,MACrBE,SAAUhB,KAAKY,MAAMI,WAIvBZ,YAAW,KACT,IACE,GAAsB,oBAAXC,OAGT,OAFAgB,QAAQC,IAAI,wBACZjB,OAAOkB,QAAQC,IAAI,IAGrBC,EAAAA,EAAAA,UAAS,IACX,CAAE,MAAOC,IACPD,EAAAA,EAAAA,UAAS,IACX,IACC,IACL,CAAE,MAAOP,GAEP,YADAlB,KAAKiB,SAAS,CAAEC,OAAO,EAAML,YAAY,GAE3C,CA3BA,CA2BA,EACD,KAEDD,MAAQ,CACNE,MAAO,GACPE,SAAU,GACVH,YAAY,EACZK,OAAO,EACR,CA9CDS,uBACEC,cAAc5B,KAAKC,mBACrB,CA8CA4B,SACE,OAAI7B,KAAK8B,QAAQ3B,WAAaH,KAAKY,MAAMC,aACvCY,EAAAA,EAAAA,UAAS,KACF7B,EAAAA,cAAA,WAAK,oBAGZA,EAAAA,cAACmC,EAAAA,EAAM,KACLnC,EAAAA,cAACoC,EAAAA,EAAS,KACRpC,EAAAA,cAACqC,EAAAA,EAAM,CAACC,MAAM,oBACdtC,EAAAA,cAACF,EAAa,KACZE,EAAAA,cAAA,UAAI,mBACJA,EAAAA,cAACL,EAAI,KACHK,EAAAA,cAACH,EAAO,KAAC,sBACa,IACpBG,EAAAA,cAAA,KACEuC,KAAK,kBACLC,OAAO,SACPC,IAAI,uBACL,WAEI,IAAI,6GAKXzC,EAAAA,cAACX,EAAG,KACFW,EAAAA,cAAC0C,EAAAA,EAAS,CACRC,GAAG,8BACHC,QAAQ,WACRC,KAAK,OACLC,MAAM,oCACNC,WAAS,EACTC,MAAO5C,KAAKY,MAAME,MAClB+B,SAAWC,GAAM9C,KAAKiB,SAAS,CAAEH,MAAOgC,EAAEV,OAAOQ,WAGrDhD,EAAAA,cAACX,EAAG,KACFW,EAAAA,cAAC0C,EAAAA,EAAS,CACRC,GAAG,8BACHC,QAAQ,WACRC,KAAMzC,KAAKY,MAAMmC,aAAe,OAAS,WACzCL,MAAM,WACNC,WAAS,EACTC,MAAO5C,KAAKY,MAAMI,SAClB6B,SAAWC,GAAM9C,KAAKiB,SAAS,CAAED,SAAU8B,EAAEV,OAAOQ,WAIxDhD,EAAAA,cAACX,EAAG,KACFW,EAAAA,cAACoD,EAAAA,EAAM,CACLxC,QAASR,KAAKQ,QACdyC,SAAUjD,KAAKY,MAAMC,WACrB2B,QAAQ,YACRU,MAAM,UACNP,WAAS,EACTF,KAAK,UACN,qBAKJzC,KAAKY,MAAMM,OACVtB,EAAAA,cAACH,EAAO,KACNG,EAAAA,cAAA,SAAG,mDAGPA,EAAAA,cAACX,EAAG,KACFW,EAAAA,cAACuD,EAAAA,KAAI,CAACC,GAAG,YAAW,oBAEtBxD,EAAAA,cAACX,EAAG,KACFW,EAAAA,cAAA,KACEuC,KAAK,8CACLC,OAAO,SACPC,IAAI,uBACL,yBAQb,EAtJI1C,EACG0D,YAAcC,EAAAA,GAwJvB,WAAeC,EAAAA,EAAAA,IAAsB5D,E","sources":["webpack://ohjelmoinnin-mooc/./src/pages/sign-in.js"],"sourcesContent":["import React from \"react\"\nimport Helmet from \"react-helmet\"\nimport Layout from \"../templates/Layout\"\nimport { authenticate, loggedIn } from \"../services/moocfi\"\nimport { navigate, Link } from \"gatsby\"\nimport { TextField, Button } from \"@material-ui/core\"\n\nimport styled from \"styled-components\"\nimport LoginStateContext, {\n  withLoginStateContext,\n} from \"../contexes/LoginStateContext\"\nimport Container from \"../components/Container\"\n\nconst Row = styled.div`\n  margin-bottom: 1.5rem;\n`\n\nconst Form = styled.form``\n\nconst InfoBox = styled.div`\n  margin-bottom: 2rem;\n`\n\nconst FormContainer = styled.div`\n  height: 100%;\n  margin-top: 2rem;\n`\n\nclass SignInPage extends React.Component {\n  static contextType = LoginStateContext\n\n  componentDidMount = () => {\n    // This is a workaroud to some really weird login redirect problems\n    this.fallbackRedirector = setInterval(() => {\n      if (!loggedIn()) {\n        return\n      }\n      setTimeout(() => {\n        if (\n          window.location.pathname === \"/sign-in/\" ||\n          window.location.pathname === \"/sign-in\"\n        ) {\n          window.location = \"/\"\n        }\n      }, 2000)\n    }, 1000)\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.fallbackRedirector)\n  }\n\n  onClick = async (e) => {\n    e.preventDefault()\n    if (\n      this.state.submitting ||\n      (this.state.email.length === 0 && this.state.password.length === 0)\n    ) {\n      return\n    }\n    this.setState({\n      submitting: true,\n      error: false,\n    })\n    try {\n      await authenticate({\n        username: this.state.email,\n        password: this.state.password,\n      })\n\n      // Give loginstate time to update\n      setTimeout(() => {\n        try {\n          if (typeof window !== \"undefined\") {\n            console.log(\"Navigating back\")\n            window.history.go(-1)\n            return\n          }\n          navigate(\"/\")\n        } catch (_e) {\n          navigate(\"/\")\n        }\n      }, 100)\n    } catch (error) {\n      this.setState({ error: true, submitting: false })\n      return\n    }\n  }\n\n  state = {\n    email: \"\",\n    password: \"\",\n    submitting: false,\n    error: false,\n  }\n\n  render() {\n    if (this.context.loggedIn && !this.state.submitting) {\n      navigate(\"/\")\n      return <div>Redirecting....</div>\n    }\n    return (\n      <Layout>\n        <Container>\n          <Helmet title=\"Kirjaudu sisään\" />\n          <FormContainer>\n            <h1>Kirjaudu sisään</h1>\n            <Form>\n              <InfoBox>\n                Tämä kurssi käyttää{\" \"}\n                <a\n                  href=\"https://mooc.fi\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  mooc.fi\n                </a>{\" \"}\n                käyttäjätunnuksia. Jos olet aikaisemmin tehnyt mooc.fi -kursseja\n                voit käyttää olemassaolevia tunnuksiasi.\n              </InfoBox>\n\n              <Row>\n                <TextField\n                  id=\"outlined-adornment-password\"\n                  variant=\"outlined\"\n                  type=\"text\"\n                  label=\"Sähköpostiosoite tai käyttäjänimi\"\n                  fullWidth\n                  value={this.state.email}\n                  onChange={(o) => this.setState({ email: o.target.value })}\n                />\n              </Row>\n              <Row>\n                <TextField\n                  id=\"outlined-adornment-password\"\n                  variant=\"outlined\"\n                  type={this.state.showPassword ? \"text\" : \"password\"}\n                  label=\"Salasana\"\n                  fullWidth\n                  value={this.state.password}\n                  onChange={(o) => this.setState({ password: o.target.value })}\n                />\n              </Row>\n\n              <Row>\n                <Button\n                  onClick={this.onClick}\n                  disabled={this.state.submitting}\n                  variant=\"contained\"\n                  color=\"primary\"\n                  fullWidth\n                  type=\"submit\"\n                >\n                  Kirjaudu sisään\n                </Button>\n              </Row>\n            </Form>\n            {this.state.error && (\n              <InfoBox>\n                <b>Virheelliset tunnukset, tarkista kirjoitusasu!</b>\n              </InfoBox>\n            )}\n            <Row>\n              <Link to=\"/sign-up\">Luo uusi tunnus</Link>\n            </Row>\n            <Row>\n              <a\n                href=\"https://tmc.mooc.fi/password_reset_keys/new\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                Unohdin salasanani\n              </a>\n            </Row>\n          </FormContainer>\n        </Container>\n      </Layout>\n    )\n  }\n}\n\nexport default withLoginStateContext(SignInPage)\n"],"names":["Row","styled","div","withConfig","displayName","componentId","Form","form","InfoBox","FormContainer","SignInPage","React","constructor","arguments","componentDidMount","this","fallbackRedirector","setInterval","loggedIn","setTimeout","window","location","pathname","onClick","async","e","preventDefault","state","submitting","email","length","password","setState","error","authenticate","username","console","log","history","go","navigate","_e","componentWillUnmount","clearInterval","render","context","Layout","Container","Helmet","title","href","target","rel","TextField","id","variant","type","label","fullWidth","value","onChange","o","showPassword","Button","disabled","color","Link","to","contextType","LoginStateContext","withLoginStateContext"],"sourceRoot":""}