{"componentChunkName":"component---src-templates-course-content-template-js","path":"/luku-3/2-kokonaisluvut-ja-liukuluvut","result":{"data":{"page":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"lead","properties":{},"children":[{"type":"text","value":"Käymme tässä osiossa läpi kokonaislukujen neljä esitysmuotoa ja IEEE-standardin mukaisen 32-bittisten liukulukujen esitysmuodon."}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Kokonaisluvut"}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Positiiviset kokonaisluvut ovat helppoja, koska niiden esitysmuoto on useimmiten (mutta ei aina!) niiden binääriarvo. Tiedon pituus pitää kuitenkin niissäkin ottaa aina huomioon, koska yleisesti ottaen vasemmanpuolimmainen bitti pitää varata etumerkille. Täten esimerkiksi 8-bittisen tavun suurin kokonaisluku on yleensä 0111 1111 eli 127 eli 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"7"}]},{"type":"text","value":"-1 eli 128-1."}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Kokonaislukujen etumerkkiin perustuva esitysmuoto"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Meille ihmisille luontevin tapa esittää kokonaisluvut on käyttää etumerkkiä, jolloin vasemmanpuolimmainen (eniten merkitsevä) bitti on positiivisille luvuille 0 ja negatiivisille 1. Esimerkiksi, +57 ja -57 ovat tavuina 0x39 ja 0x95, sekä 32-bittisinä sanoina 0x00000039 ja 0x80000039."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"+57 = 0011 1001 = 0x39 (tavuna)   +57 = 0x 00 00 00 39 (32-bittisenä sanana)\n-57 = 1011 1001 = 0xB9 (tavuna)   -57 = 0x 80 00 00 39 (32-bittisenä sanana)"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Etumerkkibitin käyttö on vähän huono kokonaislukujen aritmetiikan toteutukseen, joten sitä ei useinkaan käytetä sen vuoksi. Esitystavan parhaimpana puolena on sen soveltuvuus ihmisille, jotka ovat tottuneet etumerkkien käyttöön."}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Kokonaislukujen yhden komplementin esitysmuoto"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Pelkkää etumerkkiä paremmin laitteiston ALU-piireille sopiva esitystapa on "},{"type":"element","tagName":"a","properties":{"href":"https://fi.wikipedia.org/wiki/Komplementti_(tietotekniikka)","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"yhden komplementti"}]},{"type":"text","value":". Siinä positiivisilla luvuilla on edelleen tavallinen binääriesitys, mutta negatiiviset luvut saadaan komplementoimalla positiivisen luvun esitysmuodon "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"kaikki"}]},{"type":"text","value":" bitit. Esimerkin luvut +57 ja -57 ovat nyt tavuina 0x39 ja 0xC6, sekä sanoina 0x00000039 ja 0xFFFFFFC6."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"+57 = 0011 1001 = 0x39 (tavuna)   +57 = 0x 00 00 00 39 (32-bittisenä sanana)\n-57 = 1100 0110 = 0xC6 (tavuna)   -57 = 0x FF FF FF C6 (32-bittisenä sanana)"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vasemmanpuolimmainen (eniten merkitsevä) bitti toimii edelleen etumerkkibittinä, mutta negatiivisten lukujen lukuarvo ei ole niin helposti luettavissa. Yhden komplementin esitystavalla on se hyvä ominaisuus, että positiivisia ja negatiivisia lukuja on yhtä monta. Esimerkiksi yhden tavun arvoalue on siis [-127, +127]. Huonona puolena on, että nollalla on kaksi esitystapaa, esimerkiksi tavuina +0 = 0x00 ja -0 = 0xFF. Tästä on haittaa aritmetiikkaoperaatioissa ja vertailuoperaatioissa, kun pitää varautua kahteen nollaan. Nollaan vertailu on harmillisesti ohjelmissa huomattavan yleinen operaatio."}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Kokonaislukujen kahden komplementin esitysmuoto"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Yleensä kokonaisluvuille käytetään yhden komplementin esitysmuodon sijasta "},{"type":"element","tagName":"a","properties":{"href":"https://fi.wikipedia.org/wiki/Kahden_komplementti","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"kahden komplementin"}]},{"type":"text","value":" esitysmuotoa. Positiiviset luvut ovat edelleen tavallisessa binääriesityksessä. Negatiivisen luvun esitysmuoto saadaan nyt vastaavan positiivisen luvun esitysmuodosta komplementoimalla kaikki bitit ja lisäämällä esitysmuotoon 1. Huomaa, että binäärijärjestelmässä yhteenlasku tehdään ihan samalla tavalla kuin 10-järjestelmässäkin. Jos yhteenlaskua tehtäessä tulee muistinumero vasemmanpuolimmaisen bitin kohdalla, niin tässä tapauksessa se unohdetaan eli jätetään pois."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"               +57 = 0011 1001 = 0x39\nkomplementoi         1100 0110\nlisää 1                     +1\n               -57 = 1100 0111 = 0xC7"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vasemmanpuolimmainen bitti toimii edelleenkin etumerkkinä. Negatiivisen luvun suuruus (vastaava positiivinen arvo, itseisarvo) saadaan negatiivisen luvun esitysmuodosta ehkä vähän yllättäen samalla tavalla, komplementoimalla kaikki bitit ja lisäämällä 1."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"               -57 = 1100 0111\nkomplementoi         0011 1000\nlisää 1                     +1\nsuuruus              0011 1001 = 0x39 = +57"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Kahden komplementin esitysmuodolla on se hyvä ominaisuus, että nollia on vain yksi (tavuna 0x00)."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"              +0 = 0000 0000 = 0x00\nkomplementoi       1111 1111\nlisää 1                   +1        (unohda yhteenlaskun viim. muistinumero)\nsuuruus       -0 = 0000 0000 = 0x00 (+1:llä ja -1:llä on sama esitysmuoto)"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Huonona puolena on, että negatiivisia lukuja on nyt yksi enemmän kuin positiivisia lukuja. Tavun arvoalue on [-128,- +127]. Tämä otetaan huomioon aritmetiikkapiireissä automaattisesti."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"               -128 = 1000 0000 = 0x80\nkomplementoi          0111 1111\nlisää 1                      +1\nsuuruus               1000 0000 = 128 (Sama esitysmuoto kuin luvulla -128!!)"}]}]}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Tästä seuraa, että esimerkiksi aritmetiikkaoperaatio negaatio (esim. lauseessa Y = -X;) päättyy virhetilanteeseen, jos operandi on pienin mahdollinen negatiivinen luku (tavuna -2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"7"}]},{"type":"text","value":" = -128 ja 32-bittisenä sanana -2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"31"}]},{"type":"text","value":" =  -2 147 483 648). Kahden komplementin parhaimpana puolena on, että sille tehdyt aritmetiikkaoperaatiot ovat muita esitystapoja helpompia toteuttaa ALU:n piireillä. Tämän vuoksi se on yleisin käytössä oleva kokonaislukujen esitystapa.\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nOn myös huomionarvoista, että normaali 32-bittisten lukujen lukualue [-2 147 483 648, +2 147 483 647] ei ole ihan valtavan iso. Jos sovelluksessa tarvitaan todella suuria kokonaislukuja, niin täytyy käyttää kaksinkertaisen tarkkuuden 64-bittisiä kokonaislukuja."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Kaikissa kokonaislukujen esitysmuodoissa täytyy ottaa huomioon myös tavujen järjestys. Esimerkiksi, luvut +57 ja -57 ovat 32-bittisessä Big-Endian esitysmuodossa"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"+57 = 0x 00 00 00 39    (binääriluku 11 1001)\n-57 = 0x FF FF FF C7 "}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ja Little-Endian esitysmuodossa"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"+57 = 0x 39 00 00 00  \n-57 = 0x C7 FF FF FF"}]}]}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Kokonaislukujen vakiolisäykseen perustuva esitysmuoto"}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Joissakin tapauksissa (esim. seuraavaksi esitettävien liukulukujen yhteydessä) kokonaisluvut esitetään positiivisina binäärilukuina. Tämä tarkoittaa, että kaikki binääriluvut tulkitaan ensin etumerkittöminä kokonaislukuina ja sitten esitysmuodosta vähennetään sovittu vakio sen lukuarvon saamiseksi. Yleensä tuo vakio on n-bittiselle tiedolle 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"n-1"}]},{"type":"text","value":"-1."}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Tavussa on 8 bittiä, joten vakio on yleensä 127 (2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"7"}]},{"type":"text","value":"-1 = 01111111"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"2"}]},{"type":"text","value":"). Tällöin arvoalue [-127,+128] on suunnilleen yhtä suuri positiivisille ja negatiivisille luvuille. Suurin positiivinen luku on 128, koska suurin 8-bittinen etumerkitön kokonaisluku on 0xFF = 255 ja 255-127=128. Jos vakio olisi vaikkapa 50, niin arvoalue olisi sitten [-50,+205]. Joskus tuostakin voisi olla hyötyä!"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Luku            57 = 0011 1001\nvakiolisäys   +127 = 0111 1111\nesitysmuoto    184 = 1011 1000 = 0xB8\n\nLuku           -57\nvakiolisäys   +127\nesitysmuoto     70 = 0100 0110 = 0x46"}]}]}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Kun vakiolisäyksenä käytetään 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"n-1"}]},{"type":"text","value":"-1 (missä n on bittien lukumäärä), niin esitystavalla on kaksikin etua. Ensinnäkin, positiivisilla ja negatiivisilla luvuilla on suunnilleen yhtä iso arvoalue. Toiseksi, vasemmanpuolimmainen bitti toimii myös etumerkkinä. Toisin kuin aikaisemmissa esitysmuodoissa, etumerkkibitin arvo 0 indikoi nyt negatiivista lukua ja arvo 1 positiivista lukua."}]},{"type":"comment","value":" Quizes 3.2.1-7  "},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"6c89c73d-36bd-5683-bd8b-deedb28680af"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"4d1e932e-96b3-5e2c-b720-19c935c051ee"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"ff69658a-ed61-55b5-8ec0-544b4b1ceb4a"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"3d4935a0-276d-5c46-840a-41cb684d8481"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"431d4560-c78f-547b-8e18-f705079f8ffb"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"5ca9ba24-b6b9-5e9a-8cd9-b466a8680ac1"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"f6b69f98-3978-508c-881e-35c77b53c310"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"b8888afc-f4b5-5af3-a684-389e7bc016b7"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"2d259e50-c213-52a4-b74c-dd73b924592e"},"children":[]}]},{"type":"element","tagName":"text-box","properties":{"variant":"example","name":"Tärkeitä termejä"},"children":[{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Yhden komplementin esitysmuoto"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Kokonaislukujen yksi esitysmuoto. Negatiivisen luvun esitysmuoto saadaan komplementoimalla positiivisen luvun binääriesitysmuoto. Esitysmuodon vasemmanpuolimmainen bitti toimii etumerkkibittinä (arvo 1 negatiivisille luvuille)."}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Kahden komplementin esitysmuoto"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Kokonaislukujen yleisin esitysmuoto. Negatiivisen luvun esitysmuoto saadaan komplementoimalla positiivisen luvun binääriesitysmuoto ja lisäämällä 1. Esitysmuodon vasemmanpuolimmainen bitti toimii etumerkkibittinä (arvo 1 negatiivisille luvuille)."}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Vakiolisäykseen perustuva esitysmuoto"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Kokonaisluvun vakiolisäysesitysmuoto on positiivinen kokonaisluku, joka saadaan lisäämällä lukuarvoon jokin sovittu vakio. Esimerkiksi, 8-bittiselle tiedolle vakio on yleensä 127. Tällöin esitysmuodon vasemmanpuolimmainen bitti toimii etumerkkibittinä (arvo 0 negatiivisille luvuille)."}]}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Liukuluvut"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Kuten jo ensimmäisessä luvussa mainittiin, tietokoneissa ei ole käytettävissä reaalilukuja. Sen sijaan käytämme tietokonearitmetiikkaa varten kehitettyä reaalilukujen approksimaatiota, liukulukuja. Liukuluvuille on tyypillistä vakiomuoto ja etukäteen määritelty lukutarkkuus. Esimerkiksi, reaaliluku Π (pii) esitetään likiarvona 3.1415927 sen yleisimmässä 32-bittisessä esitysmuodossa."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Esitysmuodossa on kolme kenttää: etumerkki, lukuarvo (mantissa) ja suuruusluokka. Desimaaliluvuilla esitysmuoto toimisi seuraavanlaisesti. Mantissa skaalataan sillä tavoin, että kokonaisosassa on vain yksi numero ja desimaaliosaan otetaan vaikkapa 6 numeroa."}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"+1.23         =    + 1.230000  *  10"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"\n+123.0        =    + 1.230000  *  10"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"2"}]},{"type":"text","value":"\n-0.00123      =    - 1.230000  *  10"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"-3"}]},{"type":"text","value":"\n-0.000000123  =    - 1.230000  *  10"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"-7"}]},{"type":"text","value":"\n+123.456789   =    + 1.234568  *  10"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"2"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tietokoneessa käytämme tietenkin binäärijärjestelmää, jolloin desimaaliosan asemesta binääripisteen jälkeen luvuissa on binääriosa. Nytkin mantissa skaalataan siten, että kokonaisosaan jää vain yksi numero. Normaalissa 32-bitin esitysmuodossa mantissassa on 24 bittiä, mutta tässä esimerkissä mantissassa on vain 9 bittiä yhteensä, joista 8 on binääriosassa. Esimerkin esitystarkkuus on siten 9 bittiä, mikä ei vastaa edes 3 desimaalinumeron tarkkuutta."}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"+1.5"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"text","value":"   =   +1.1        =  +  1.10000000    * 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"\n+2.5"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"text","value":"   =  +10.1        =  +  1.01000000    * 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"\n-96.75"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"text","value":" =  -1100000.11  =  -  1.10000011    * 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"6"}]},{"type":"text","value":"\n+96.875"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"text","value":" = +1100000.111 =  +  1.10000100    * 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"6"}]},{"type":"text","value":" (pyöristetty)\n\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tietokoneiden alkuaikoina jokaisella valmistajalla oli oma tapansa esittää liukulukuja, mutta tästä aiheutui liikaa harmia. On jo tarpeeksi ärsyttävää laskea koko ajan likiarvoilla, saati sitten niin että sama ohjelma antaa erilaisia (likiarvo) tuloksia eri koneilla. Jo vuodesta 1985 käytössä on ollut "},{"type":"element","tagName":"a","properties":{"href":"https://fi.wikipedia.org/wiki/Liukuluku","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"IEEE 754"}]},{"type":"text","value":" standardi liukulukujen esitysmuodolle ja aritmetiikalle. Standardin uusin päivitys on vuodelta 2008. Nyt lähes kaikki suorittimet noudattavat tuota standardia ja laskevat likiarvonsa samalla tavalla. Esittelemme tässä nyt standardin pääperiaatteet 32-bittisille liukuluvuille."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"IEEE:n 32-bittisessä standardissa liukulukujen esitysmuoto on seuraavanlainen. Vasemmanpuolimmainen bitti on etumerkki, ja se on 0 positiivisille luvuille ja 1 negatiivisille luvuille. Seuraavat 8 bittiä ovat eksponentti, ja sen esitysmuoto on vakiolisäys 127. Loput 23 bittiä ovat mantissalle, joka yleisessä tapauksessa esitetään "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"normalisoidussa muodossa"}]},{"type":"text","value":". Normalisoinnissa mantissa skaalataan ensin siten, että kokonaisosassa on vain yksi numero. Koska kyseessä on binäärijärjestelmä, tuo numero on aina 1, joten sitä ei tarvitse tallettaa! Sitä kutsutaan "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"piilobitiksi"}]},{"type":"text","value":". Normalisoidusta luvusta talletetaan siis vain mantissan binääriosa. Tällä nerokkaalla tempulla saamme 23 bittiin talletettua 24 bittiä informaatiota, eli lukutarkkuus kaksinkertaistuu."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Eksponentin esitysmuoto on siis aina positiivinen kokonaisluku. Miksi tämä esitysmuoto, eikä joku noista muista? Perusteluna on, että liukulukuaritmetiikkaa toteutettaessa eksponentteja käsitellään vain niiden esitysmuotoina välittämättä eksponenttien todellisista arvoista. Normalisointi ja muut liukulukuaritmetiikkaan liittyvät operaatiot on helpompi toteuttaa, kun käsiteltävänä on vain positiivisia lukuja eksponettikentissä."}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Esimerkiksi, luku -96.75 on binäärinä -1100000.11 ja normalisoidussa muodossa -1.10000011 * 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"6"}]},{"type":"text","value":". Etumerkki ('-') talletetaan bittinä 1, eksponentti 6 muodossa 6+127=133=10000101, ja mantissasta vain sen binääriosa .10000011 23 bitillä 0x41800 (1000 0011 -> "},{"type":"element","tagName":"nobr","properties":{},"children":[{"type":"text","value":"100 0001 1000 0000 0000 0000"}]},{"type":"text","value":" = 0x41800)."}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"-96.75"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"text","value":"   = -1.1000 0011    * 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"6"}]},{"type":"text","value":"\n    → 1 100 0 010 1 100 0001 1000 0000 0000 0000 = 0xC2C18000\n"}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Toinen esimerkki. Luku +346.875 on binäärinä +101011010.111 ja normalisoituna +1.010 1101 0111 * 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"8"}]},{"type":"text","value":". Etumerkki talletetaan bittinä 0, eksponentti muodossa 8+127=135=10000111, ja mantissa 23-bittisessä muodossa 0x2D7000 "},{"type":"element","tagName":"nobr","properties":{},"children":[{"type":"text","value":"(= 010 1101 0111 0000 0000 0000"}]},{"type":"text","value":")."}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"+345.875"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"text","value":" = +1.0101 1010 111 * 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"8"}]},{"type":"text","value":"\n    → 0 100 0 011 1 010 1101 0111 0000 0000 0000 = 0x43AD7000\n"}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Vastaavasti, jos muistissa olevan liukuluvun X esitysmuoto on 0x40780000 ("},{"type":"element","tagName":"nobr","properties":{},"children":[{"type":"text","value":"= 0 100 0000 0 111 1000 0000 0000 0000"}]},{"type":"text","value":"), niin mikä on X:n arvo? Etumerkkibitti on 0, joten luku on positiivinen. Eksponentin esitysmuoto on 1000 0000=128, joten eksponentin arvo on 128-127=1. Mantissan binääriosan esitysmuoto on 0x780000=111 1000 0000 0000 0000 0000, joten piilobitin kanssa mantissa on 1.1111. Muuttujan X arvo on nyt siis 1.1111*2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"1"}]},{"type":"text","value":" = 11.111 = 3.875"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"text","value":"."}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"\n0x40780000 = 0 100 0000 0 111 1000 0000 0000 0000\n    → +1.1111 * 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"1"}]},{"type":"text","value":" = +11.111"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"2"}]},{"type":"text","value":" =  3.875"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"text","value":"\n\n"}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Liukulukujen erikoistapaukset"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Liukuluvuille on erikseen määritelty muutama esitysmuodon erityistapaus. Ensinnäkin siellä on ±0, joissa kaikki eksponentin ja mantissan bitit ovat nollia. Siellä on myös määritelty ±∞, joissa exponenttikenttä on 0xFF ja mantissakenttä on nolla. Lisäksi on vielä \"alustamaton liukuluku\" (NaN, Not a Number), jota on vielä kahta muotoa. Niissä molemmissa eksponenttikenttä on 0xFF ja mantissakenttä nollasta poikkeava. Toisessa muodossa alustamattoman luvun käyttö aiheuttaa keskeytyksen ja toisessa ei."}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"±0 =           0/1 0000 0000 00...0\n±∞ =           0/1 1111 1111 00...0\nQuiet Nan:     0/1 1111 1111  1?..?1?..?  (nollasta poikkeava mantissakenttä)\nSignaling Nan: 0/1 1111 1111  0?..?1?..?  (nollasta poikkeava mantissakenttä)\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Normalisointi asettaa omat rajoituksensa sille, kuinka pieniä liukulukuja voi esittää, koska normalisoidun liukuluvun kokonaisosa on aina 1. Hyvin pienille "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"ei-normalisoiduille luvuille"}]},{"type":"text","value":" on oma esitystapansa, joka on koodattu eksponenttikenttänä 0 ja nollasta poikkeavana mantissakenttänä. Tuollaisilla luvuilla eksponentti on aina -126 ja piilobitin arvo on 0. Nimensä mukaisesti mantissaa ei ole normeerattu tavalliseen tapaan, vaan se on skaalattu eksponenttiin -126 sopivaksi."}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"+1.14794 \\* 10"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"-40"}]},{"type":"text","value":" = 0.0000 0010 1 \\* 2"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"-126"}]},{"type":"text","value":"\n    → 0 000 0000 0 000 0001 0100 0000 0000 0000 = 0x00014000\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Huonona puolena tällaisissa (itseisarvoltaan) hyvin pienissä luvuissa on esitystarkkuuden heikentyminen. Edellisessä esimerkissä merkitseviä bittejä on vain 17, kun normaalisti liukulukujen tarkkuus on 24 bittiä. Jokainen nollabitti ei-normalisoidun mantissan alussa puolittaa lukutarkkuuden."}]},{"type":"comment","value":" Quizes 3.2.8-10 "},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"4b8be024-2ab5-584f-b1a2-cf5f6db9e1a3"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"2e49679e-bfd4-51b4-925a-5710b85f7da4"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"f7d141fa-1bed-5e52-93b9-1a01580de869"},"children":[]}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Liukulukulaskenta"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Liukulukulaskenta on hieman erilaista kuin mitä koulussa on opittu reaalilukulaskennasta. Esimerkkinä tarkastellaan tilannetta, jossa muuttujan X arvo on 1.0 ja muuttujan Y arvo on 0.00000001. Jos laskemme nämä luvut yhteen (Z=X+Y), niin reaaliluvuilla laskettaessa summan pitäisi olla 1.00000001. Liukuluvuilla (IEEE:n 32-bittinen standardi) laskettaessa tulos on kuitenkin 1.0, koska Y:n bitit jäävät pois normeeratussa 24 bitin esitysmuodossa."}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"1.000000"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"text","value":" + 0.00000001"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"text","value":" = 1.00000001"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"text","value":"\n1.000 0000 0000 0000 0000 0000 0001 0101"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"2"}]},{"type":"text","value":"\n    → 1.000 0000 0000 0000 0000 0000"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"2"}]},{"type":"text","value":" (24 bittiä)\n\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Toinen ongelma liukulukulaskennassa on lukujen vertailu. Reaaliluvuilla on ihan normaalia verrata kahta lukua toisiinsa, mutta liukuluvuilla suora vertailu ei useinkaan toimi lähes samanarvoisten lukujen kanssa, koska liukulukujen esitystarkkuus tulee ottaa huomioon. Täten esimerkiksi lause \""},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"if (X+Y == 3.0) then ..."}]},{"type":"text","value":"\" ei useinkaan toimi oikein. Liukulukujen vertailussa yhtäsuuruuteen täytyy riittää, että ne ovat \"riittävän lähellä\" toisiaan. Sama epätarkkuus pitää ottaa huomioon vertailtaessa, onko jokin liukuluku suurempi tai pienempi kuin toinen."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Esimerkki: Liukulukulaskennan epätarkkuus\n\nX = 20.3;  -- tallentuu lukuna 20.299999\nY = 1.33;  -- tallentuu lukuna  1.33000004\nZ = X+Y;   -- tulos on luku 21.629999\nif (Z == 21.63)     -- koodi toimii väärin, tarkoitus oli haarautua\nthen ....\n\nZ = X+Y-21.63;\nif ( |Z| < 0.00001)   -- koodi toimii oikein\nthen ....             -- epsilon 0.00001 pitää valita viisaasti!\n\n--\n\nif (Y < Z) -- koodi ei välttämättä toimi oikein\n           -- esim. Y = 3.00000011 ja Z = 3.00000008\nthen  ....\n\nif ( Y < 0.99999 * Z)  -- koodi toimii varmemmin oikein\nthen ...."}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Pitkäkestoisessa (tunteja, päiviä, viikkoja?) liukulukulaskennassa ongelmana voi olla, että käytössä olevien liukulukujen esitystarkkuus pikkuhiljaa heikkenee. Tämä pätee erityisesti vähennyslaskuun, jos molemmat operandit ovat suunnilleen samankokoisia. Lukujen vasemmanpuoleiset merkitsevät bitit kumoavat toisensa ja tuloksen normalisoinnin yhteydessä oikealta täytetään nolla-biteillä ilman mitään parempaa tietoa. Kerran menetettyä todellista esitystarkkuutta ei koskaan voi saada takaisin. Joissakin järjestelmissä tällaista tiedon rappeutumista vastaan taistellaan alustamalla (boottamalla) järjestelmä aika ajoin, jolloin liikkeelle lähdetään taas \"puhtaalta pöydältä\" ja mahdollisimman tarkan datan pohjalta."}]},{"type":"element","tagName":"text-box","properties":{"variant":"example","name":"Tärkeitä termejä"},"children":[{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"IEEE-754 liukulukustandardi"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tietokonevalmistajien yhteisesti sopima standardi liukulukujen esitysmuotoon ja liukulukulaskentaan. Standardia käyttämällä sama ohjelma antaa periaatteessa samat laskentatulokset kaikilla standardia käyttävillä tietokoneilla, olettaen että kaikki laskennassa käytetyt standardin parametrit ovat samoja. Tällaisia parametreja ovat esim. liukuluvun koko bitteinä ja laskennan lopputuloksen pyöristystapa. 32-bittisessä standardissa on 1 bitti etumerkille, 8 bittiä eksponentille ja 23 bittiä normalisoidulle mantissalle."}]}]}]},"html":"<div><div>\n<lead>Käymme tässä osiossa läpi kokonaislukujen neljä esitysmuotoa ja IEEE-standardin mukaisen 32-bittisten liukulukujen esitysmuodon.</lead>\n</div><h2>Kokonaisluvut</h2><div>Positiiviset kokonaisluvut ovat helppoja, koska niiden esitysmuoto on useimmiten (mutta ei aina!) niiden binääriarvo. Tiedon pituus pitää kuitenkin niissäkin ottaa aina huomioon, koska yleisesti ottaen vasemmanpuolimmainen bitti pitää varata etumerkille. Täten esimerkiksi 8-bittisen tavun suurin kokonaisluku on yleensä 0111 1111 eli 127 eli 2<sup>7</sup>-1 eli 128-1.</div><h3>Kokonaislukujen etumerkkiin perustuva esitysmuoto</h3><p>Meille ihmisille luontevin tapa esittää kokonaisluvut on käyttää etumerkkiä, jolloin vasemmanpuolimmainen (eniten merkitsevä) bitti on positiivisille luvuille 0 ja negatiivisille 1. Esimerkiksi, +57 ja -57 ovat tavuina 0x39 ja 0x95, sekä 32-bittisinä sanoina 0x00000039 ja 0x80000039.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+57 = 0011 1001 = 0x39 (tavuna)   +57 = 0x 00 00 00 39 (32-bittisenä sanana)\n-57 = 1011 1001 = 0xB9 (tavuna)   -57 = 0x 80 00 00 39 (32-bittisenä sanana)</code></pre></div><p>Etumerkkibitin käyttö on vähän huono kokonaislukujen aritmetiikan toteutukseen, joten sitä ei useinkaan käytetä sen vuoksi. Esitystavan parhaimpana puolena on sen soveltuvuus ihmisille, jotka ovat tottuneet etumerkkien käyttöön.</p><h3>Kokonaislukujen yhden komplementin esitysmuoto</h3><p>Pelkkää etumerkkiä paremmin laitteiston ALU-piireille sopiva esitystapa on <a href=\"https://fi.wikipedia.org/wiki/Komplementti_(tietotekniikka)\" target=\"_blank\" rel=\"noopener noreferrer\">yhden komplementti</a>. Siinä positiivisilla luvuilla on edelleen tavallinen binääriesitys, mutta negatiiviset luvut saadaan komplementoimalla positiivisen luvun esitysmuodon <em>kaikki</em> bitit. Esimerkin luvut +57 ja -57 ovat nyt tavuina 0x39 ja 0xC6, sekä sanoina 0x00000039 ja 0xFFFFFFC6.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+57 = 0011 1001 = 0x39 (tavuna)   +57 = 0x 00 00 00 39 (32-bittisenä sanana)\n-57 = 1100 0110 = 0xC6 (tavuna)   -57 = 0x FF FF FF C6 (32-bittisenä sanana)</code></pre></div><p>Vasemmanpuolimmainen (eniten merkitsevä) bitti toimii edelleen etumerkkibittinä, mutta negatiivisten lukujen lukuarvo ei ole niin helposti luettavissa. Yhden komplementin esitystavalla on se hyvä ominaisuus, että positiivisia ja negatiivisia lukuja on yhtä monta. Esimerkiksi yhden tavun arvoalue on siis [-127, +127]. Huonona puolena on, että nollalla on kaksi esitystapaa, esimerkiksi tavuina +0 = 0x00 ja -0 = 0xFF. Tästä on haittaa aritmetiikkaoperaatioissa ja vertailuoperaatioissa, kun pitää varautua kahteen nollaan. Nollaan vertailu on harmillisesti ohjelmissa huomattavan yleinen operaatio.</p><h3>Kokonaislukujen kahden komplementin esitysmuoto</h3><p>Yleensä kokonaisluvuille käytetään yhden komplementin esitysmuodon sijasta <a href=\"https://fi.wikipedia.org/wiki/Kahden_komplementti\" target=\"_blank\" rel=\"noopener noreferrer\">kahden komplementin</a> esitysmuotoa. Positiiviset luvut ovat edelleen tavallisessa binääriesityksessä. Negatiivisen luvun esitysmuoto saadaan nyt vastaavan positiivisen luvun esitysmuodosta komplementoimalla kaikki bitit ja lisäämällä esitysmuotoon 1. Huomaa, että binäärijärjestelmässä yhteenlasku tehdään ihan samalla tavalla kuin 10-järjestelmässäkin. Jos yhteenlaskua tehtäessä tulee muistinumero vasemmanpuolimmaisen bitin kohdalla, niin tässä tapauksessa se unohdetaan eli jätetään pois.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">               +57 = 0011 1001 = 0x39\nkomplementoi         1100 0110\nlisää 1                     +1\n               -57 = 1100 0111 = 0xC7</code></pre></div><p>Vasemmanpuolimmainen bitti toimii edelleenkin etumerkkinä. Negatiivisen luvun suuruus (vastaava positiivinen arvo, itseisarvo) saadaan negatiivisen luvun esitysmuodosta ehkä vähän yllättäen samalla tavalla, komplementoimalla kaikki bitit ja lisäämällä 1.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">               -57 = 1100 0111\nkomplementoi         0011 1000\nlisää 1                     +1\nsuuruus              0011 1001 = 0x39 = +57</code></pre></div><p>Kahden komplementin esitysmuodolla on se hyvä ominaisuus, että nollia on vain yksi (tavuna 0x00).</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">              +0 = 0000 0000 = 0x00\nkomplementoi       1111 1111\nlisää 1                   +1        (unohda yhteenlaskun viim. muistinumero)\nsuuruus       -0 = 0000 0000 = 0x00 (+1:llä ja -1:llä on sama esitysmuoto)</code></pre></div><p>Huonona puolena on, että negatiivisia lukuja on nyt yksi enemmän kuin positiivisia lukuja. Tavun arvoalue on [-128,- +127]. Tämä otetaan huomioon aritmetiikkapiireissä automaattisesti.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">               -128 = 1000 0000 = 0x80\nkomplementoi          0111 1111\nlisää 1                      +1\nsuuruus               1000 0000 = 128 (Sama esitysmuoto kuin luvulla -128!!)</code></pre></div><div>Tästä seuraa, että esimerkiksi aritmetiikkaoperaatio negaatio (esim. lauseessa Y = -X;) päättyy virhetilanteeseen, jos operandi on pienin mahdollinen negatiivinen luku (tavuna -2<sup>7</sup> = -128 ja 32-bittisenä sanana -2<sup>31</sup> =  -2 147 483 648). Kahden komplementin parhaimpana puolena on, että sille tehdyt aritmetiikkaoperaatiot ovat muita esitystapoja helpompia toteuttaa ALU:n piireillä. Tämän vuoksi se on yleisin käytössä oleva kokonaislukujen esitystapa.\n<br><br>\nOn myös huomionarvoista, että normaali 32-bittisten lukujen lukualue [-2 147 483 648, +2 147 483 647] ei ole ihan valtavan iso. Jos sovelluksessa tarvitaan todella suuria kokonaislukuja, niin täytyy käyttää kaksinkertaisen tarkkuuden 64-bittisiä kokonaislukuja.</div><p>Kaikissa kokonaislukujen esitysmuodoissa täytyy ottaa huomioon myös tavujen järjestys. Esimerkiksi, luvut +57 ja -57 ovat 32-bittisessä Big-Endian esitysmuodossa</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+57 = 0x 00 00 00 39    (binääriluku 11 1001)\n-57 = 0x FF FF FF C7 </code></pre></div><p>ja Little-Endian esitysmuodossa</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+57 = 0x 39 00 00 00  \n-57 = 0x C7 FF FF FF</code></pre></div><h3>Kokonaislukujen vakiolisäykseen perustuva esitysmuoto</h3><div>Joissakin tapauksissa (esim. seuraavaksi esitettävien liukulukujen yhteydessä) kokonaisluvut esitetään positiivisina binäärilukuina. Tämä tarkoittaa, että kaikki binääriluvut tulkitaan ensin etumerkittöminä kokonaislukuina ja sitten esitysmuodosta vähennetään sovittu vakio sen lukuarvon saamiseksi. Yleensä tuo vakio on n-bittiselle tiedolle 2<sup>n-1</sup>-1.</div><div>Tavussa on 8 bittiä, joten vakio on yleensä 127 (2<sup>7</sup>-1 = 01111111<sub>2</sub>). Tällöin arvoalue [-127,+128] on suunnilleen yhtä suuri positiivisille ja negatiivisille luvuille. Suurin positiivinen luku on 128, koska suurin 8-bittinen etumerkitön kokonaisluku on 0xFF = 255 ja 255-127=128. Jos vakio olisi vaikkapa 50, niin arvoalue olisi sitten [-50,+205]. Joskus tuostakin voisi olla hyötyä!</div><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Luku            57 = 0011 1001\nvakiolisäys   +127 = 0111 1111\nesitysmuoto    184 = 1011 1000 = 0xB8\n\nLuku           -57\nvakiolisäys   +127\nesitysmuoto     70 = 0100 0110 = 0x46</code></pre></div><div>Kun vakiolisäyksenä käytetään 2<sup>n-1</sup>-1 (missä n on bittien lukumäärä), niin esitystavalla on kaksikin etua. Ensinnäkin, positiivisilla ja negatiivisilla luvuilla on suunnilleen yhtä iso arvoalue. Toiseksi, vasemmanpuolimmainen bitti toimii myös etumerkkinä. Toisin kuin aikaisemmissa esitysmuodoissa, etumerkkibitin arvo 0 indikoi nyt negatiivista lukua ja arvo 1 positiivista lukua.</div><!-- Quizes 3.2.1-7  --><div><quiz id=\"6c89c73d-36bd-5683-bd8b-deedb28680af\"></quiz></div>\n<div><quiz id=\"4d1e932e-96b3-5e2c-b720-19c935c051ee\"></quiz></div>\n<div><quiz id=\"ff69658a-ed61-55b5-8ec0-544b4b1ceb4a\"></quiz></div>\n<div><quiz id=\"3d4935a0-276d-5c46-840a-41cb684d8481\"></quiz></div>\n<div><quiz id=\"431d4560-c78f-547b-8e18-f705079f8ffb\"></quiz></div>\n<div><quiz id=\"5ca9ba24-b6b9-5e9a-8cd9-b466a8680ac1\"></quiz></div>\n<div><quiz id=\"f6b69f98-3978-508c-881e-35c77b53c310\"></quiz></div>\n<div><quiz id=\"b8888afc-f4b5-5af3-a684-389e7bc016b7\"></quiz></div>\n<div><quiz id=\"2d259e50-c213-52a4-b74c-dd73b924592e\"></quiz></div><text-box variant=\"example\" name=\"Tärkeitä termejä\"><h3>Yhden komplementin esitysmuoto</h3><p>Kokonaislukujen yksi esitysmuoto. Negatiivisen luvun esitysmuoto saadaan komplementoimalla positiivisen luvun binääriesitysmuoto. Esitysmuodon vasemmanpuolimmainen bitti toimii etumerkkibittinä (arvo 1 negatiivisille luvuille).</p><h3>Kahden komplementin esitysmuoto</h3><p>Kokonaislukujen yleisin esitysmuoto. Negatiivisen luvun esitysmuoto saadaan komplementoimalla positiivisen luvun binääriesitysmuoto ja lisäämällä 1. Esitysmuodon vasemmanpuolimmainen bitti toimii etumerkkibittinä (arvo 1 negatiivisille luvuille).</p><h3>Vakiolisäykseen perustuva esitysmuoto</h3><p>Kokonaisluvun vakiolisäysesitysmuoto on positiivinen kokonaisluku, joka saadaan lisäämällä lukuarvoon jokin sovittu vakio. Esimerkiksi, 8-bittiselle tiedolle vakio on yleensä 127. Tällöin esitysmuodon vasemmanpuolimmainen bitti toimii etumerkkibittinä (arvo 0 negatiivisille luvuille).</p></text-box><h2>Liukuluvut</h2><p>Kuten jo ensimmäisessä luvussa mainittiin, tietokoneissa ei ole käytettävissä reaalilukuja. Sen sijaan käytämme tietokonearitmetiikkaa varten kehitettyä reaalilukujen approksimaatiota, liukulukuja. Liukuluvuille on tyypillistä vakiomuoto ja etukäteen määritelty lukutarkkuus. Esimerkiksi, reaaliluku Π (pii) esitetään likiarvona 3.1415927 sen yleisimmässä 32-bittisessä esitysmuodossa.</p><p>Esitysmuodossa on kolme kenttää: etumerkki, lukuarvo (mantissa) ja suuruusluokka. Desimaaliluvuilla esitysmuoto toimisi seuraavanlaisesti. Mantissa skaalataan sillä tavoin, että kokonaisosassa on vain yksi numero ja desimaaliosaan otetaan vaikkapa 6 numeroa.</p><pre>\n+1.23         =    + 1.230000  *  10<sup>0</sup>\n+123.0        =    + 1.230000  *  10<sup>2</sup>\n-0.00123      =    - 1.230000  *  10<sup>-3</sup>\n-0.000000123  =    - 1.230000  *  10<sup>-7</sup>\n+123.456789   =    + 1.234568  *  10<sup>2</sup>\n</pre><p>Tietokoneessa käytämme tietenkin binäärijärjestelmää, jolloin desimaaliosan asemesta binääripisteen jälkeen luvuissa on binääriosa. Nytkin mantissa skaalataan siten, että kokonaisosaan jää vain yksi numero. Normaalissa 32-bitin esitysmuodossa mantissassa on 24 bittiä, mutta tässä esimerkissä mantissassa on vain 9 bittiä yhteensä, joista 8 on binääriosassa. Esimerkin esitystarkkuus on siten 9 bittiä, mikä ei vastaa edes 3 desimaalinumeron tarkkuutta.</p><pre>\n+1.5<sub>10</sub>   =   +1.1        =  +  1.10000000    * 2<sup>0</sup>\n+2.5<sub>10</sub>   =  +10.1        =  +  1.01000000    * 2<sup>1</sup>\n-96.75<sub>10</sub> =  -1100000.11  =  -  1.10000011    * 2<sup>6</sup>\n+96.875<sub>10</sub> = +1100000.111 =  +  1.10000100    * 2<sup>6</sup> (pyöristetty)\n\n</pre><p>Tietokoneiden alkuaikoina jokaisella valmistajalla oli oma tapansa esittää liukulukuja, mutta tästä aiheutui liikaa harmia. On jo tarpeeksi ärsyttävää laskea koko ajan likiarvoilla, saati sitten niin että sama ohjelma antaa erilaisia (likiarvo) tuloksia eri koneilla. Jo vuodesta 1985 käytössä on ollut <a href=\"https://fi.wikipedia.org/wiki/Liukuluku\" target=\"_blank\" rel=\"noopener noreferrer\">IEEE 754</a> standardi liukulukujen esitysmuodolle ja aritmetiikalle. Standardin uusin päivitys on vuodelta 2008. Nyt lähes kaikki suorittimet noudattavat tuota standardia ja laskevat likiarvonsa samalla tavalla. Esittelemme tässä nyt standardin pääperiaatteet 32-bittisille liukuluvuille.</p><p>IEEE:n 32-bittisessä standardissa liukulukujen esitysmuoto on seuraavanlainen. Vasemmanpuolimmainen bitti on etumerkki, ja se on 0 positiivisille luvuille ja 1 negatiivisille luvuille. Seuraavat 8 bittiä ovat eksponentti, ja sen esitysmuoto on vakiolisäys 127. Loput 23 bittiä ovat mantissalle, joka yleisessä tapauksessa esitetään <em>normalisoidussa muodossa</em>. Normalisoinnissa mantissa skaalataan ensin siten, että kokonaisosassa on vain yksi numero. Koska kyseessä on binäärijärjestelmä, tuo numero on aina 1, joten sitä ei tarvitse tallettaa! Sitä kutsutaan <em>piilobitiksi</em>. Normalisoidusta luvusta talletetaan siis vain mantissan binääriosa. Tällä nerokkaalla tempulla saamme 23 bittiin talletettua 24 bittiä informaatiota, eli lukutarkkuus kaksinkertaistuu.</p><p>Eksponentin esitysmuoto on siis aina positiivinen kokonaisluku. Miksi tämä esitysmuoto, eikä joku noista muista? Perusteluna on, että liukulukuaritmetiikkaa toteutettaessa eksponentteja käsitellään vain niiden esitysmuotoina välittämättä eksponenttien todellisista arvoista. Normalisointi ja muut liukulukuaritmetiikkaan liittyvät operaatiot on helpompi toteuttaa, kun käsiteltävänä on vain positiivisia lukuja eksponettikentissä.</p><div>Esimerkiksi, luku -96.75 on binäärinä -1100000.11 ja normalisoidussa muodossa -1.10000011 * 2<sup>6</sup>. Etumerkki ('-') talletetaan bittinä 1, eksponentti 6 muodossa 6+127=133=10000101, ja mantissasta vain sen binääriosa .10000011 23 bitillä 0x41800 (1000 0011 -> <nobr>100 0001 1000 0000 0000 0000</nobr> = 0x41800).</div><pre>\n-96.75<sub>10</sub>   = -1.1000 0011    * 2<sup>6</sup>\n    &rarr; 1 100 0 010 1 100 0001 1000 0000 0000 0000 = 0xC2C18000\n</pre><div>Toinen esimerkki. Luku +346.875 on binäärinä +101011010.111 ja normalisoituna +1.010 1101 0111 * 2<sup>8</sup>. Etumerkki talletetaan bittinä 0, eksponentti muodossa 8+127=135=10000111, ja mantissa 23-bittisessä muodossa 0x2D7000 <nobr>(= 010 1101 0111 0000 0000 0000</nobr>).</div><pre>\n+345.875<sub>10</sub> = +1.0101 1010 111 * 2<sup>8</sup>\n    &rarr; 0 100 0 011 1 010 1101 0111 0000 0000 0000 = 0x43AD7000\n</pre><div>Vastaavasti, jos muistissa olevan liukuluvun X esitysmuoto on 0x40780000 (<nobr>= 0 100 0000 0 111 1000 0000 0000 0000</nobr>), niin mikä on X:n arvo? Etumerkkibitti on 0, joten luku on positiivinen. Eksponentin esitysmuoto on 1000 0000=128, joten eksponentin arvo on 128-127=1. Mantissan binääriosan esitysmuoto on 0x780000=111 1000 0000 0000 0000 0000, joten piilobitin kanssa mantissa on 1.1111. Muuttujan X arvo on nyt siis 1.1111*2<sup>1</sup> = 11.111 = 3.875<sub>10</sub>.</div><pre>\n\n0x40780000 = 0 100 0000 0 111 1000 0000 0000 0000\n    &rarr; +1.1111 * 2<sup>1</sup> = +11.111<sub>2</sub> =  3.875<sub>10</sub>\n\n</pre><h3>Liukulukujen erikoistapaukset</h3><p>Liukuluvuille on erikseen määritelty muutama esitysmuodon erityistapaus. Ensinnäkin siellä on ±0, joissa kaikki eksponentin ja mantissan bitit ovat nollia. Siellä on myös määritelty ±∞, joissa exponenttikenttä on 0xFF ja mantissakenttä on nolla. Lisäksi on vielä \"alustamaton liukuluku\" (NaN, Not a Number), jota on vielä kahta muotoa. Niissä molemmissa eksponenttikenttä on 0xFF ja mantissakenttä nollasta poikkeava. Toisessa muodossa alustamattoman luvun käyttö aiheuttaa keskeytyksen ja toisessa ei.</p><pre>\n±0 =           0/1 0000 0000 00...0\n±&infin; =           0/1 1111 1111 00...0\nQuiet Nan:     0/1 1111 1111  1?..?1?..?  (nollasta poikkeava mantissakenttä)\nSignaling Nan: 0/1 1111 1111  0?..?1?..?  (nollasta poikkeava mantissakenttä)\n</pre><p>Normalisointi asettaa omat rajoituksensa sille, kuinka pieniä liukulukuja voi esittää, koska normalisoidun liukuluvun kokonaisosa on aina 1. Hyvin pienille <em>ei-normalisoiduille luvuille</em> on oma esitystapansa, joka on koodattu eksponenttikenttänä 0 ja nollasta poikkeavana mantissakenttänä. Tuollaisilla luvuilla eksponentti on aina -126 ja piilobitin arvo on 0. Nimensä mukaisesti mantissaa ei ole normeerattu tavalliseen tapaan, vaan se on skaalattu eksponenttiin -126 sopivaksi.</p><pre>\n+1.14794 \\* 10<sup>-40</sup> = 0.0000 0010 1 \\* 2<sup>-126</sup>\n    &rarr; 0 000 0000 0 000 0001 0100 0000 0000 0000 = 0x00014000\n</pre><p>Huonona puolena tällaisissa (itseisarvoltaan) hyvin pienissä luvuissa on esitystarkkuuden heikentyminen. Edellisessä esimerkissä merkitseviä bittejä on vain 17, kun normaalisti liukulukujen tarkkuus on 24 bittiä. Jokainen nollabitti ei-normalisoidun mantissan alussa puolittaa lukutarkkuuden.</p><!-- Quizes 3.2.8-10 --><div><quiz id=\"4b8be024-2ab5-584f-b1a2-cf5f6db9e1a3\"></quiz></div>\n<div><quiz id=\"2e49679e-bfd4-51b4-925a-5710b85f7da4\"></quiz></div>\n<div><quiz id=\"f7d141fa-1bed-5e52-93b9-1a01580de869\"></quiz></div><h3>Liukulukulaskenta</h3><p>Liukulukulaskenta on hieman erilaista kuin mitä koulussa on opittu reaalilukulaskennasta. Esimerkkinä tarkastellaan tilannetta, jossa muuttujan X arvo on 1.0 ja muuttujan Y arvo on 0.00000001. Jos laskemme nämä luvut yhteen (Z=X+Y), niin reaaliluvuilla laskettaessa summan pitäisi olla 1.00000001. Liukuluvuilla (IEEE:n 32-bittinen standardi) laskettaessa tulos on kuitenkin 1.0, koska Y:n bitit jäävät pois normeeratussa 24 bitin esitysmuodossa.</p><pre>\n1.000000<sub>10</sub> + 0.00000001<sub>10</sub> = 1.00000001<sub>10</sub>\n1.000 0000 0000 0000 0000 0000 0001 0101<sub>2</sub>\n    &rarr; 1.000 0000 0000 0000 0000 0000<sub>2</sub> (24 bittiä)\n\n</pre><p>Toinen ongelma liukulukulaskennassa on lukujen vertailu. Reaaliluvuilla on ihan normaalia verrata kahta lukua toisiinsa, mutta liukuluvuilla suora vertailu ei useinkaan toimi lähes samanarvoisten lukujen kanssa, koska liukulukujen esitystarkkuus tulee ottaa huomioon. Täten esimerkiksi lause \"<em>if (X+Y == 3.0) then ...</em>\" ei useinkaan toimi oikein. Liukulukujen vertailussa yhtäsuuruuteen täytyy riittää, että ne ovat \"riittävän lähellä\" toisiaan. Sama epätarkkuus pitää ottaa huomioon vertailtaessa, onko jokin liukuluku suurempi tai pienempi kuin toinen.</p><div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Esimerkki: Liukulukulaskennan epätarkkuus\n\nX = 20.3;  -- tallentuu lukuna 20.299999\nY = 1.33;  -- tallentuu lukuna  1.33000004\nZ = X+Y;   -- tulos on luku 21.629999\nif (Z == 21.63)     -- koodi toimii väärin, tarkoitus oli haarautua\nthen ....\n\nZ = X+Y-21.63;\nif ( |Z| &lt; 0.00001)   -- koodi toimii oikein\nthen ....             -- epsilon 0.00001 pitää valita viisaasti!\n\n--\n\nif (Y &lt; Z) -- koodi ei välttämättä toimi oikein\n           -- esim. Y = 3.00000011 ja Z = 3.00000008\nthen  ....\n\nif ( Y &lt; 0.99999 * Z)  -- koodi toimii varmemmin oikein\nthen ....</code></pre></div><p>Pitkäkestoisessa (tunteja, päiviä, viikkoja?) liukulukulaskennassa ongelmana voi olla, että käytössä olevien liukulukujen esitystarkkuus pikkuhiljaa heikkenee. Tämä pätee erityisesti vähennyslaskuun, jos molemmat operandit ovat suunnilleen samankokoisia. Lukujen vasemmanpuoleiset merkitsevät bitit kumoavat toisensa ja tuloksen normalisoinnin yhteydessä oikealta täytetään nolla-biteillä ilman mitään parempaa tietoa. Kerran menetettyä todellista esitystarkkuutta ei koskaan voi saada takaisin. Joissakin järjestelmissä tällaista tiedon rappeutumista vastaan taistellaan alustamalla (boottamalla) järjestelmä aika ajoin, jolloin liikkeelle lähdetään taas \"puhtaalta pöydältä\" ja mahdollisimman tarkan datan pohjalta.</p><text-box variant=\"example\" name=\"Tärkeitä termejä\"><h3>IEEE-754 liukulukustandardi</h3><p>Tietokonevalmistajien yhteisesti sopima standardi liukulukujen esitysmuotoon ja liukulukulaskentaan. Standardia käyttämällä sama ohjelma antaa periaatteessa samat laskentatulokset kaikilla standardia käyttävillä tietokoneilla, olettaen että kaikki laskennassa käytetyt standardin parametrit ovat samoja. Tällaisia parametreja ovat esim. liukuluvun koko bitteinä ja laskennan lopputuloksen pyöristystapa. 32-bittisessä standardissa on 1 bitti etumerkille, 8 bittiä eksponentille ja 23 bittiä normalisoidulle mantissalle.</p></text-box></div>","frontmatter":{"path":"/luku-3/2-kokonaisluvut-ja-liukuluvut","title":"Kokonaislukujen ja liukulukujen esitysmuodot"}},"allPages":{"edges":[{"node":{"id":"f84c69b8-0195-598e-b051-638a517adb15","frontmatter":{"path":"/arvostelu-ja-kokeet","title":"Arvostelu ja kokeet"}}},{"node":{"id":"97559a5f-7228-505c-a45a-e0873044f86b","frontmatter":{"path":"/credits","title":"Tekijänoikeudet ja lisenssit"}}},{"node":{"id":"b5e3212a-e9e7-5514-87e6-07e3f18fee95","frontmatter":{"path":"/opettajille","title":"Opettajille ja opinto-ohjaajille"}}},{"node":{"id":"a0c4823b-46b6-5707-beb2-8a229b5a2beb","frontmatter":{"path":"/osaamistavoitteet","title":"Osaamistavoitteet"}}},{"node":{"id":"a0c06bb0-616a-594f-b31a-cf57faa3a1ed","frontmatter":{"path":"/tukivaylat","title":"Tukiväylät"}}},{"node":{"id":"dbb6d14b-2dea-5f9a-85fc-30eb59a77a70","frontmatter":{"path":"/","title":""}}},{"node":{"id":"ea6e5cfa-14c1-53b5-99da-25b985ab3a7b","frontmatter":{"path":"/usein-kysytyt-kysymykset","title":"Palaute ja usein kysytyt kysymykset"}}},{"node":{"id":"cafd05e1-5355-5bf8-a41c-b955593fd3fd","frontmatter":{"path":"/luku-1/1-mika-on-tietokone","title":"Tietokone"}}},{"node":{"id":"d9390807-bada-58ad-a2b0-59515c977a08","frontmatter":{"path":"/luku-1/2-ohjelma","title":"Ohjelma"}}},{"node":{"id":"7c078337-dddc-5acf-ab5e-7ade2e1444c5","frontmatter":{"path":"/luku-1/3-laitteiston-nopeuserot","title":"Laitteiston nopeuserot"}}},{"node":{"id":"03eacc49-4552-5b0b-bd14-e18ee30fea39","frontmatter":{"path":"/luku-1","title":"Luku 1: Tietokonejärjestelmä ja ohjelma?"}}},{"node":{"id":"8fd68708-1f3b-5ded-857f-4ff583ebe0a2","frontmatter":{"path":"/luku-2/1-suorittimen-rakenne","title":"Suorittimen rakenne"}}},{"node":{"id":"25190d7c-3ec2-5d92-bc9b-a9eaea77075b","frontmatter":{"path":"/luku-2/2-suoritussykli","title":"Käskyjen nouto- ja suoritussykli"}}},{"node":{"id":"a23135b2-b131-59cd-b1c6-cfefd4c12714","frontmatter":{"path":"/luku-2/3-konekaskyt","title":"Konekäskyt"}}},{"node":{"id":"c9b57a30-4ec9-53c6-ba7e-6e2d020edf88","frontmatter":{"path":"/luku-2/4-tiedon-sijainti","title":"Tiedon sijainti suoritusaikana"}}},{"node":{"id":"bb32b4c9-f268-5ee0-ab30-2c8015858045","frontmatter":{"path":"/luku-2","title":"Luku 2: Suoritin ja muisti"}}},{"node":{"id":"0363ae7c-d894-551b-b701-4d6154421c91","frontmatter":{"path":"/luku-3/1-tiedon-kategoriat","title":"Tiedon kategoriat, binääri- ja heksadesimaalijärjestelmät, monitavuisen tiedon tallennus"}}},{"node":{"id":"b4f1ad3e-ddda-5fe0-81b4-1d3cd70451ca","frontmatter":{"path":"/luku-3/2-kokonaisluvut-ja-liukuluvut","title":"Kokonaislukujen ja liukulukujen esitysmuodot"}}},{"node":{"id":"90801e3d-d0e8-5485-86f5-8e0192f5535e","frontmatter":{"path":"/luku-3/3-taulukot-tietueet","title":"Taulukot, tietueet ja muu rakenteinen tieto"}}},{"node":{"id":"6dddcd21-639d-504f-88cc-db830c98f75c","frontmatter":{"path":"/luku-3/4-merkit-etc","title":"Merkit, kuvat ja tunteenpalo"}}},{"node":{"id":"f778c926-0e93-5b7a-9b50-5fd503f42528","frontmatter":{"path":"/luku-3","title":"Luku 3: Tiedon esitysmuodot"}}},{"node":{"id":"3d13f5ae-50f5-5454-a662-9bf3e2bde459","frontmatter":{"path":"/luku-4/1-kayttojarjestelman-tehtavat","title":"Käyttöjärjestelmän tehtävät"}}},{"node":{"id":"3187dc8f-8296-53a6-b73a-9880d556ae9b","frontmatter":{"path":"/luku-4/2-prosessi","title":"Prosessi"}}},{"node":{"id":"b74906bf-020f-526d-a4a0-d079accbb347","frontmatter":{"path":"/luku-4/3-kayttojarjestelman-toteutus","title":"Käyttöjärjestelmän toteutus"}}},{"node":{"id":"7c3125f9-4d7c-52fe-83e1-bf564067c597","frontmatter":{"path":"/luku-4/4-laskentakyvyn-rajat","title":"Tietokoneen laskentakyvyn rajat"}}},{"node":{"id":"20ffd10f-ce80-5f7e-9c31-cf0bc2bb2edd","frontmatter":{"path":"/luku-4","title":"Luku 4: Käyttöjärjestelmä ja laskentakyvyn rajat"}}}]}},"pageContext":{}},"staticQueryHashes":["2283872788","994120085"]}